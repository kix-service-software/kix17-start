# --
# Copyright (C) 2006-2023 KIX Service Software GmbH, https://www.kixdesk.com
# --
# This software comes with ABSOLUTELY NO WARRANTY. For details, see
# the enclosed file LICENSE for license information (AGPL). If you
# did not receive this file, see https://www.gnu.org/licenses/agpl.txt.
# --


<div id="Scratchpad" class="WidgetSimple CanDrag Expanded">
    <div class="Header">
        <div class="WidgetAction Toggle" title="[% Translate("Show or hide the content.") | html %]" id="KIXSidebarScratchPadBlockOpen" aria-controls="Core_UI_AutogeneratedID_0" aria-expanded="false"></div>
        <h2><span>[% Translate(Data.Title) | html %]</span></h2>
    </div>
    <div class="Content">
        <form action="[% Env("CGIHandle") %]" method="post" name="ScratchPad" id="ScratchPad" enctype="multipart/form-data" class="PreventMultipleSubmits Validate">
            <input type="hidden" name="Action" value="ScratchpadAJAXHandler" />
            <input type="hidden" name="Subaction" value="UpdateNotes" />
            <input type="hidden" name="TicketID" value="[% Data.TicketID | html %]" />
            <input type="hidden" id="ScratchPadResult" name="ScratchPadResult" value="0" />
            <textarea id="ScratchPadNotes" name="Notes" class="Validate_MaxLength Validate_Length_2000" rows="8">[% Data.Notes | html %]</textarea>
            <div id="ScratchPadNotesError" class="TooltipErrorMessage">
                <p>[% Translate("This field's content can not be longer than %s characters.", "2000") | html %]</p>
            </div>
            <button type="button" id="ScratchPadSubmit" name="ScratchPadSubmit" class="CallForAction"  value="[% Translate("Save") | html %]"><span><i class="fa fa-check"></i> [% Translate("Save") | html %]</span></button>
            <span id="ScratchPadSaved" class="Hidden">
                <span class="ContentSaved"><i class="fa fa-check"></i> [% Translate("saved") | html %]</span>
            </span>
        </form>
    </div>
</div>

[% WRAPPER JSOnDocumentComplete %]
<script type="text/javascript">//<![CDATA[
    $('#ScratchPadSubmit').on('click', function (Event) {
        Core.AJAX.FormUpdate($('#ScratchPad'), 'UpdateNotes', 'ScratchPadNotes', ['ScratchPadResult'],
            function() {
                if ($('#ScratchPadResult').val() == 1)
                    $('#ScratchPadSaved').removeClass('Hidden');
            },
            'ScratchpadAJAXHandler');
    });
    $('#ScratchPadNotes').on('keydown', function (Event) {
        if (!$('#ScratchPadSaved').hasClass('Hidden')) {
            $('#ScratchPadSaved').addClass('Hidden');
            $('#ScratchPadResult').val('0');
        }
    });
//]]></script>
[% END %]
