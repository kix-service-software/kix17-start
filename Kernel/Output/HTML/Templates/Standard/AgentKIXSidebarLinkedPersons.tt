# --
# Copyright (C) 2006-2019 c.a.p.e. IT GmbH, https://www.cape-it.de
# --
# This software comes with ABSOLUTELY NO WARRANTY. For details, see
# the enclosed file LICENSE for license information (AGPL). If you
# did not receive this file, see https://www.gnu.org/licenses/agpl.txt.
# --


[% RenderBlockStart("SidebarWidget") %]
<div id="LinkedPersons" class="WidgetSimple Collapsed CanDrag">
    <div class="Header">
        <div class="WidgetAction Toggle">
            <a  title="[% Translate(Data.Description) | html %]" href="#" id="LinkedPersonsBlockOpen" aria-controls="Core_UI_AutogeneratedID_0" aria-expanded="false">
                <i class="fa fa-caret-right"></i>
                <i class="fa fa-caret-down"></i>
            </a>
        </div>
        <h2 class="WithToggle"><span>[% Translate(Data.Title) | html %]</span></h2>
    </div>
    <div id="LinkedPersonsTable" class="Content">
    </div>
</div>
[% RenderBlockEnd("SidebarWidget") %]

[% RenderBlockStart("SidebarContent") %]
[% RenderBlockStart("NonAgentNotifyInformation") %]
        <div class="SpacingBottom">
            <strong>
                <u>[% Translate("PLEASE NOTE") | html %]:</u>
            </strong>
            <br />
            <div style="margin-top:5px">[% Translate("Persons of types \"Customer\" and \"3rd Party\" will not be notified when an internal article is created!") | html %]</div>
        </div>
[% RenderBlockEnd("NonAgentNotifyInformation") %]
        <table class="DataTable">
            <thead>
                <tr>
                    <th><span title='[% Translate("As article recipient") | html %]'><i class="fa fa-envelope"></i></span></th>
[% RenderBlockStart("AsCallContactTitle") %]
                    <th><span title='[% Translate("As call contact") | html %]'><i class="fa fa-phone"></i></span></th>
[% RenderBlockEnd("AsCallContactTitle") %]
                    <th>[% Translate("Name") | html %]</th>
                    <th>[% Translate("Type") | html %]</th>
                </tr>
            </thead>
            <tbody>
[% RenderBlockStart("LinkedPerson") %]
                <tr>
                    <td>
[% RenderBlockStart("InformPersonByMail") %]
                        [% Data.PersonRecipientTypeStrg %]
                        <input class="LinkedPersonMail" name="LinkedPersonMail" type="hidden" value="[% Data.UserEmail | html %]"/>
[% RenderBlockEnd("InformPersonByMail") %]
[% RenderBlockStart("InformPersonByEvent") %]
                        <input title="[% Translate("Select this person to receive a copy of the new article via email") | html %]" name="LinkedPersonToInform" type="checkbox" value="[% Data.UserType | html %]:::[% Data.UserID | html %]"/>
[% RenderBlockEnd("InformPersonByEvent") %]
                    </td>
[% RenderBlockStart("AsCallContact") %]
                    <td>
[% IF Data.IsAgent != 1 %]
                        <input class='LinkedPersonToCallContact' title='[% Translate("Set this person as call contact.") | html %]' name="LinkedPersonToCallContact_[% Data.UserID | html %]" type="checkbox" value='"[% Data.UserFirstname | html %] [% Data.UserLastname | html %]" <[% Data.UserEmail | html %]>:::[% Data.UserID | html %]'/>
[% END %]
                    </td>
[% RenderBlockEnd("AsCallContact") %]
                    <td class="PersonDetails" title="[% Translate("Click to view detailed informations for this persons") | html %]">
                        [% Data.UserFirstname | html %] [% Data.UserLastname | html %]
                        <input class="LinkedPersonID" name="LinkedPersonID" type="hidden" value="[% Data.UserLogin | html %]"/>
                    </td>
                    <td>[% Translate(Data.LinkType) | html %]</td>
                </tr>
[% RenderBlockEnd("LinkedPerson") %]
            </tbody>
        </table>
[% RenderBlockStart("LinkedPersonDetails") %]
        <div id="LinkedPersonDetails[% Data.UserLogin | html %]" class="WidgetPopup Hidden LinkedPersonDetails">
            <div class="Header">
                 <h2><span>[% Translate("Person Information") | html %]: [% Data.UserFirstname | html %] [% Data.UserLastname | html %]</span></h2>
            </div>
            <div class="Content">
                <div class="Spacing">
                    <fieldset class="TableLike FixedLabelSmall">
[% RenderBlockStart("PersonData") %]
                        <label>[% Translate(Data.Label) | html %]:</label>
                        <p class="Value" title="[% Data.Content | html %]">[% Data.Content | truncate(35) | html %]</p>
[% RenderBlockEnd("PersonData") %]
                        <div class="Clear"></div>
                    </fieldset>
                </div>
            </div>
        </div>
[% RenderBlockEnd("LinkedPersonDetails") %]
[% RenderBlockEnd("SidebarContent") %]
